(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{38:function(e,t,a){},59:function(e,t,a){},90:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),c=a(14),r=a.n(c),i=(a(59),a(8)),l=a.n(i),o=a(16),u=a(10),j=a(94),d=a(25),h=a(6),b=a(34),p=a(92),m=a(50),x=a(97),O=a(93),f=a(33),g=a(26),v=[{featureType:"administrative",elementType:"all",stylers:[{saturation:"-100"}]},{featureType:"administrative.province",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{saturation:-100},{lightness:65},{visibility:"on"}]},{featureType:"poi",elementType:"all",stylers:[{saturation:-100},{lightness:"50"},{visibility:"simplified"}]},{featureType:"road",elementType:"all",stylers:[{saturation:"-100"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"all",stylers:[{lightness:"30"}]},{featureType:"road.local",elementType:"all",stylers:[{lightness:"40"}]},{featureType:"transit",elementType:"all",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"water",elementType:"geometry",stylers:[{hue:"#ffff00"},{lightness:-25},{saturation:-97}]},{featureType:"water",elementType:"labels",stylers:[{lightness:-25},{saturation:-100}]}],y=(a(61),a(17)),w=a.n(y);w.a.interceptors.request.use((function(e){return localStorage.access?e.headers.Authorization="Bearer ".concat(localStorage.access):delete e.headers.Authorization,e}),(function(e){return Promise.reject(e)})),w.a.interceptors.response.use((function(e){return e}),(function(e){var t,a=e.config,s=localStorage.refresh;return s&&401===e.response.status&&"token_not_valid"===(null===(t=e.response)||void 0===t?void 0:t.data.code)&&!a._retry?(a._retry=!0,w.a.post("".concat("http://localhost:8000","/api/token/refresh/"),{refresh:s}).then((function(e){if(200===e.status)return console.log(e.data),localStorage.setItem("access",e.data.access),w()(a)}))):Promise.reject(e)}));var N=w.a,k=a.p+"static/media/icon.3db2cad4.png",S=a(1);var C=function(e){var t,a=e.user,c=Object(s.useState)({}),r=Object(u.a)(c,2),i=r[0],j=r[1],d=Object(s.useState)(""),h=Object(u.a)(d,2),y=h[0],C=h[1],T=Object(s.useState)({}),_=Object(u.a)(T,2),P=_[0],$=_[1],L=Object(s.useState)(!1),F=Object(u.a)(L,2),E=F[0],A=F[1],I=Object(s.useState)(0),D=Object(u.a)(I,2),U=D[0],z=D[1],R={styles:v,disableDefaultUI:!0},B=Object(b.c)({googleMapsApiKey:"AIzaSyAbE5oW_KVEDundMDGXDUe94Fz5xwqqf0s",libraries:["places"]}),M=B.isLoaded,V=B.loadError,W=n.a.useRef(),q=n.a.useCallback((function(e){W.current=e}),[]),K=n.a.useCallback((function(e){var t=e.lat,a=e.lng;W.current.panTo({lat:t,lng:a}),W.current.setZoom(15)}),[]);if(navigator.geolocation.getCurrentPosition((function(e){t={lat:e.coords.latitude,lng:e.coords.longitude}}),(function(){return null})),V)return"Error Loading Maps";if(!M)return"Loading Maps";function J(){return(J=Object(o.a)(l.a.mark((function e(s){var n,c,r,o,u,d,h;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),e.prev=1,n=s.target[1].value,c=s.target[2].value,t?(r=t,j(t)):r=i,o=a?a.id:"",!r){e.next=20;break}return e.next=9,w.a.post("/api/",{location:r,genre:n,price:c,user_id:o});case 9:u=e.sent,d=u.data,C(d),A(d.favorite),z(d.visits),h=d.geometry.location,$(h),K(h),window.location.href="#mainPageSearch",e.next=21;break;case 20:window.alert("Please enter the correct inputs!");case 21:e.next=28;break;case 23:e.prev=23,e.t0=e.catch(1),K(P),console.log(e.t0),window.alert("No restaurants found! Please change some inputs!");case 28:case"end":return e.stop()}}),e,null,[[1,23]])})))).apply(this,arguments)}function G(e){return H.apply(this,arguments)}function H(){return(H=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.post("api/set_restaurant_favorite/",{restaurant_id:y.place_id,user_id:a.id,restaurant_details:{place_id:y.place_id,name:y.name,lat:y.geometry.location.lat,lng:y.geometry.location.lng,vicitiny:y.vicinity}});case 3:A(!E),K(P),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function X(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(o.a)(l.a.mark((function e(t){var s,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"add"===t?(n="/api/visit_restaurant/",s=1):(n="/api/reduce_visit_restaurant/",s=0===U?0:-1),e.next=4,N.post(n,{restaurant_id:y.place_id,user_id:a.id,restaurant_details:{place_id:y.place_id,name:y.name,lat:y.geometry.location.lat,lng:y.geometry.location.lng,vicitiny:y.vicinity}});case 4:z(U+s),K(P),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function Q(){var e=Object(f.a)(),a=e.ready,s=e.value,n=e.suggestions,c=n.status,r=n.data,i=e.setValue,u=e.clearSuggestions;function j(){return(j=Object(o.a)(l.a.mark((function e(a){var s,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i(a,!1),u(),e.next=5,Object(f.b)({address:a});case 5:return s=e.sent,e.next=8,Object(f.c)(s[0]);case 8:n=e.sent,t=n,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}return Object(S.jsx)("div",{children:Object(S.jsxs)(g.a,{onSelect:function(e){return j.apply(this,arguments)},children:[Object(S.jsx)(g.b,{value:s,onChange:function(e){i(e.target.value)},disabled:!a,placeholder:"Leave blank to use current location",className:"mainPageInput"}),Object(S.jsx)(g.d,{children:"OK"===c&&r.map((function(e){var t=e.place_id,a=e.description;return Object(S.jsx)(g.c,{value:a,className:"searchDropDown"},t)}))})]})})}return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(p.a,{className:"justify-content-center",children:Object(S.jsxs)(m.a,{className:"col-10 col-md-8",children:[Object(S.jsxs)(p.a,{className:"justify-content-center",children:[Object(S.jsx)("img",{src:k,width:"30",height:"35",className:"mt-2 mr-1"}),Object(S.jsx)("h1",{children:"What2Eat?"})]}),Object(S.jsx)(p.a,{className:"justify-content-center text-center",children:Object(S.jsx)("h5",{children:"Too busy to think about lunch? Is indecisive your middle name? Let W2E decide for you lah."})}),Object(S.jsx)(p.a,{className:"justify-content-center text-center",style:{fontSize:"10px"},children:"Searches are limited to a 500m radius because you're probably too lazy to walk anyway"}),Object(S.jsx)(p.a,{children:Object(S.jsx)(m.a,{className:"col-12",children:Object(S.jsxs)(x.a,{onSubmit:function(e){return J.apply(this,arguments)},children:[Object(S.jsx)(p.a,{className:"mb-3 mt-3",children:Object(S.jsx)(m.a,{children:Object(S.jsx)(Q,{})})}),Object(S.jsxs)(p.a,{children:[Object(S.jsx)(m.a,{className:"col-12 col-sm-12 col-md-6 col-lg-6 mb-3",children:Object(S.jsx)(x.a.Control,{placeholder:"Cuisine: Surprise Me!",className:"mainPageInput"})}),Object(S.jsx)(m.a,{className:"col-12 col-sm-12 col-md-6 col-lg-6",children:Object(S.jsxs)(x.a.Control,{as:"select",className:"mainPageInput",children:[Object(S.jsx)("option",{value:"Surprise Me!",children:"Price: Default $$"}),Object(S.jsx)("option",{value:"$",children:"$"}),Object(S.jsx)("option",{value:"$$",children:"$$"}),Object(S.jsx)("option",{value:"$$$",children:"$$$"}),Object(S.jsx)("option",{value:"$$$$",children:"$$$$"})]})})]}),Object(S.jsx)(p.a,{className:" mt-3 text-center",children:Object(S.jsx)(m.a,{className:"col-12",children:Object(S.jsx)(O.a,{type:"submit",variant:"danger",id:"mainPageSearch",style:{width:"100%"},children:y?"Something Else!":"Feed Me Now!"})})})]})})})]})}),y?Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(p.a,{className:"justify-content-center text-center",children:Object(S.jsxs)(m.a,{className:"col-10 col-md-8",children:[Object(S.jsx)("h5",{className:"mt-3",children:"Here you go friend, something to eat so you wouldn't starve."}),Object(S.jsx)("h3",{children:y.name}),Object(S.jsx)("h5",{children:y.vicinity}),Object(S.jsx)("h5",{children:y.rating?"Rating: ".concat(y.rating,"/5"):"No Rating"}),a?Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("h5",{children:["Visits: ",U]}),Object(S.jsxs)("div",{children:[Object(S.jsx)(p.a,{className:"mt-2 text-center",children:Object(S.jsx)(m.a,{className:"col-12",children:E?Object(S.jsx)(O.a,{variant:"success",onClick:G,style:{width:"100%"},children:"Favorite Place"}):Object(S.jsx)(O.a,{variant:"warning",onClick:G,style:{width:"100%"},children:"Add to favorites"})})}),Object(S.jsx)(p.a,{className:"mt-2  text-center",children:Object(S.jsx)(m.a,{children:Object(S.jsx)(O.a,{variant:"warning",onClick:function(){return X("add")},style:{width:"100%"},children:"Log Visit"})})}),Object(S.jsx)(p.a,{className:"mt-2  text-center",children:Object(S.jsx)(m.a,{children:Object(S.jsx)(O.a,{variant:"warning",onClick:function(){return X("minus")},style:{width:"100%"},children:"Remove Visit"})})})]})]}):Object(S.jsx)(S.Fragment,{})]})}),Object(S.jsx)(p.a,{className:"m-3",children:Object(S.jsx)(b.a,{mapContainerStyle:{width:"100vw",height:"50vw"},zoom:10,center:{lat:1.3521,lng:103.8198},options:R,onLoad:q,id:"mapsection",children:P?Object(S.jsx)(b.b,{position:{lat:P.lat,lng:P.lng},icon:{url:{logo:k},scaledSize:new window.google.maps.Size(30,30),origin:new window.google.maps.Point(0,0)}}):""})})]}):""]})},T=a(22),_=a(23);a(38);var P=function(e){var t=e.setAuth,a=Object(s.useState)({username:"",email:"",password:"",confirmPassword:""}),n=Object(u.a)(a,2),c=n[0],r=n[1],i=Object(h.f)();function d(){return(d=Object(o.a)(l.a.mark((function e(a){var s,n,r,o,u,j;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,w.a.post("/accounts/register/",c);case 4:return window.alert("Registration successful!"),e.next=7,N.post("/accounts/login/",c);case 7:s=e.sent,n=s.data,localStorage.setItem("access",n.access),localStorage.setItem("refresh",n.refresh),t(!0),i.push("/"),e.next=22;break;case 15:for(u in e.prev=15,e.t0=e.catch(1),r=e.t0.response.data,o=[],r)for(j in r[u])o.push("- "+r[u][j]);o.length<10?window.alert("The following errors have occured: \n"+o.join("\n")):window.alert("An error has occured, please try again!"),console.log(e.t0);case 22:case"end":return e.stop()}}),e,null,[[1,15]])})))).apply(this,arguments)}function b(e){r(Object(_.a)(Object(_.a)({},c),{},Object(T.a)({},e.target.name,e.target.value)))}return Object(S.jsx)(j.a,{className:"justify-content-center",style:{maxWidth:"300px"},children:Object(S.jsxs)(x.a,{className:"FormBackground p-4 mt-5",children:[Object(S.jsx)("h3",{className:"text-center",children:"Sign Up"}),Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{children:"User name"}),Object(S.jsx)("input",{type:"text",className:"form-control",placeholder:"Username",name:"username",onChange:b})]}),Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{children:"Email address"}),Object(S.jsx)("input",{type:"email",className:"form-control",placeholder:"Enter email",name:"email",onChange:b})]}),Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{children:"Password"}),Object(S.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter password",name:"password",onChange:b})]}),Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{children:"Confirm Password"}),Object(S.jsx)("input",{type:"password",className:"form-control",placeholder:"Confirm password",name:"confirmPassword",onChange:b})]}),Object(S.jsx)(O.a,{type:"submit",className:"btn btn-primary btn-block",variant:"danger",onClick:function(e){return d.apply(this,arguments)},children:"Sign Up"}),Object(S.jsx)("p",{className:"forgot-password text-center mt-1",children:Object(S.jsx)("a",{href:"/login",children:"Already registered? Click here to Login!"})})]})})};var $=function(e){var t=e.setAuth,a=Object(s.useState)({username:"",password:""}),n=Object(u.a)(a,2),c=n[0],r=n[1],i=Object(h.f)();function d(){return(d=Object(o.a)(l.a.mark((function e(a){var s,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,N.post("/accounts/login/",c);case 4:s=e.sent,n=s.data,localStorage.setItem("access",n.access),localStorage.setItem("refresh",n.refresh),t(!0),i.push("/"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function b(e){r(Object(_.a)(Object(_.a)({},c),{},Object(T.a)({},e.target.name,e.target.value)))}return Object(S.jsx)(j.a,{className:"justify-content-center",style:{maxWidth:"300px"},children:Object(S.jsxs)(x.a,{className:"FormBackground p-4 mt-5",children:[Object(S.jsx)("h3",{className:"text-center",children:"Login"}),Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{children:"User name"}),Object(S.jsx)("input",{type:"text",className:"form-control",placeholder:"Username",name:"username",onChange:b})]}),Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{children:"Password"}),Object(S.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter password",name:"password",onChange:b})]}),Object(S.jsx)(O.a,{type:"submit",className:"btn btn-primary btn-block",variant:"danger",onClick:function(e){return d.apply(this,arguments)},children:"Login"}),Object(S.jsx)("p",{className:"forgot-password text-center mt-1",children:Object(S.jsx)("a",{href:"/signup",children:"Not yet registered? Click here to Signup!"})})]})})},L=a(96),F=a(98),E=a.p+"static/media/icon.3db2cad4.png";var A=function(e){var t=e.user,a=e.setUser,s=e.setAuth,n=Object(h.f)();return Object(S.jsx)(L.a,{style:{"background-color":"#97a97c"},expand:"md",children:Object(S.jsxs)(j.a,{children:[Object(S.jsx)(L.a.Brand,{href:E,children:"What2Eat?"}),Object(S.jsx)(L.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(S.jsx)(L.a.Collapse,{id:"basic-navbar-nav",className:"justify-content-end",children:Object(S.jsx)(F.a,{className:"me-auto",children:(null===t||void 0===t?void 0:t.username)?Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(F.a.Link,{href:"/",style:{color:"black"},onClick:function(e){e.preventDefault(),localStorage.clear(),s(!1),a(null),n.push("/")},children:"Logout"}),Object(S.jsxs)(F.a.Link,{href:"/profile",style:{color:"black"},children:["Profile: ",t.username]})]}):Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(F.a.Link,{href:"/signup",style:{color:"black"},children:"Signup"}),Object(S.jsx)(F.a.Link,{href:"/login",style:{color:"black"},children:"Login"})]})})})]})})},I=a(95);var D=function(e){var t=e.user,a=e.userRestaurants,n=Object(s.useState)(!1),c=Object(u.a)(n,2),r=c[0];return c[1],Object(S.jsx)(j.a,{className:"justify-content-center",style:{maxWidth:"500px"},children:r?Object(S.jsx)(S.Fragment,{}):Object(S.jsxs)("div",{className:"FormBackground p-4 mt-4 text-center",children:[Object(S.jsx)("h3",{className:"text-center",children:"Profile"}),Object(S.jsxs)("div",{className:!0,children:["Username: ",t.username]}),Object(S.jsxs)("div",{children:["Email: ",t.email]}),Object(S.jsxs)("div",{className:"text-center mt-3",children:[Object(S.jsx)("h4",{className:"text-center",children:"Places Visited"}),Object(S.jsxs)(I.a,{striped:!0,bordered:!0,hover:!0,size:"sm",children:[Object(S.jsx)("thead",{children:Object(S.jsxs)("tr",{children:[Object(S.jsx)("th",{children:"Restaurant"}),Object(S.jsx)("th",{children:"Vists"})]})}),Object(S.jsx)("tbody",{children:null===a||void 0===a?void 0:a.map((function(e){return Object(S.jsxs)("tr",{children:[Object(S.jsxs)("td",{children:[e.favorite?"\u2b50":"",e.restaurant_name]}),Object(S.jsx)("td",{children:e.visits})]})}))})]})]})]})})},U=a(54);a.n(U).a.config();var z=function(){var e=Object(s.useState)(!1),t=Object(u.a)(e,2),a=t[0],n=t[1],c=Object(s.useState)({}),r=Object(u.a)(c,2),i=r[0],b=r[1],p=Object(s.useState)([]),m=Object(u.a)(p,2),x=m[0],O=m[1];return Object(s.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.get("/accounts/user/");case 3:t=e.sent,a=t.data,b(a.user_profile),O(a.user_stats),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),n(!1),b(null),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[a]),Object(S.jsxs)(d.a,{children:[Object(S.jsx)(A,{user:i,setUser:n,setAuth:n}),Object(S.jsx)(j.a,{className:"justify-content-center mt-3",children:Object(S.jsxs)(h.c,{children:[Object(S.jsx)(h.a,{path:"/",exact:!0,children:Object(S.jsx)(C,{user:i})}),Object(S.jsx)(h.a,{path:"/signup",children:Object(S.jsx)(P,{setAuth:n})}),Object(S.jsx)(h.a,{path:"/login",children:Object(S.jsx)($,{setAuth:n})}),Object(S.jsx)(h.a,{path:"/profile",children:Object(S.jsx)(D,{user:i,userRestaurants:x})})]})})]})},R=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,99)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),s(e),n(e),c(e),r(e)}))};a(89);r.a.render(Object(S.jsx)(z,{}),document.getElementById("root")),R()}},[[90,1,2]]]);
//# sourceMappingURL=main.170ac2b3.chunk.js.map