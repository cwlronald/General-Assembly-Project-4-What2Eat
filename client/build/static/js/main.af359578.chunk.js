(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{38:function(e,t,a){},59:function(e,t,a){},90:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),c=a(14),r=a.n(c),l=(a(59),a(8)),i=a.n(l),o=a(16),u=a(10),j=a(94),d=a(25),h=a(6),p=a(34),b=a(92),m=a(50),x=a(97),O=a(93),f=a(33),g=a(26),v=[{featureType:"administrative",elementType:"all",stylers:[{saturation:"-100"}]},{featureType:"administrative.province",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{saturation:-100},{lightness:65},{visibility:"on"}]},{featureType:"poi",elementType:"all",stylers:[{saturation:-100},{lightness:"50"},{visibility:"simplified"}]},{featureType:"road",elementType:"all",stylers:[{saturation:"-100"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"all",stylers:[{lightness:"30"}]},{featureType:"road.local",elementType:"all",stylers:[{lightness:"40"}]},{featureType:"transit",elementType:"all",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"water",elementType:"geometry",stylers:[{hue:"#ffff00"},{lightness:-25},{saturation:-97}]},{featureType:"water",elementType:"labels",stylers:[{lightness:-25},{saturation:-100}]}],y=(a(61),a(17)),w=a.n(y);w.a.interceptors.request.use((function(e){return localStorage.access?e.headers.Authorization="Bearer ".concat(localStorage.access):delete e.headers.Authorization,e}),(function(e){return Promise.reject(e)})),w.a.interceptors.response.use((function(e){return e}),(function(e){var t,a=e.config,s=localStorage.refresh;return s&&401===e.response.status&&"token_not_valid"===(null===(t=e.response)||void 0===t?void 0:t.data.code)&&!a._retry?(a._retry=!0,w.a.post("".concat("http://localhost:8000","/api/token/refresh/"),{refresh:s}).then((function(e){if(200===e.status)return console.log(e.data),localStorage.setItem("access",e.data.access),w()(a)}))):Promise.reject(e)}));var N=w.a,k=a(1);var S=function(e){var t,a=e.user,c=Object(s.useState)({}),r=Object(u.a)(c,2),l=r[0],j=r[1],d=Object(s.useState)(""),h=Object(u.a)(d,2),y=h[0],S=h[1],C=Object(s.useState)({}),T=Object(u.a)(C,2),_=T[0],P=T[1],$=Object(s.useState)(!1),L=Object(u.a)($,2),F=L[0],E=L[1],A=Object(s.useState)(0),I=Object(u.a)(A,2),D=I[0],U=I[1],z={styles:v,disableDefaultUI:!0},R=Object(p.c)({googleMapsApiKey:"AIzaSyAbE5oW_KVEDundMDGXDUe94Fz5xwqqf0s",libraries:["places"]}),B=R.isLoaded,M=R.loadError,V=n.a.useRef(),W=n.a.useCallback((function(e){V.current=e}),[]),q=n.a.useCallback((function(e){var t=e.lat,a=e.lng;V.current.panTo({lat:t,lng:a}),V.current.setZoom(15)}),[]);if(navigator.geolocation.getCurrentPosition((function(e){t={lat:e.coords.latitude,lng:e.coords.longitude}}),(function(){return null})),M)return"Error Loading Maps";if(!B)return"Loading Maps";function K(){return(K=Object(o.a)(i.a.mark((function e(s){var n,c,r,o,u,d,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),e.prev=1,n=s.target[1].value,c=s.target[2].value,t?(r=t,j(t)):r=l,o=a?a.id:"",!r){e.next=20;break}return e.next=9,w.a.post("http://localhost:8000/api/",{location:r,genre:n,price:c,user_id:o});case 9:u=e.sent,d=u.data,S(d),E(d.favorite),U(d.visits),h=d.geometry.location,P(h),q(h),window.location.href="#mainPageSearch",e.next=21;break;case 20:window.alert("Please enter the correct inputs!");case 21:e.next=28;break;case 23:e.prev=23,e.t0=e.catch(1),q(_),console.log(e.t0),window.alert("No restaurants found! Please change some inputs!");case 28:case"end":return e.stop()}}),e,null,[[1,23]])})))).apply(this,arguments)}function J(e){return G.apply(this,arguments)}function G(){return(G=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.post("http://localhost:8000/api/set_restaurant_favorite/",{restaurant_id:y.place_id,user_id:a.id,restaurant_details:{place_id:y.place_id,name:y.name,lat:y.geometry.location.lat,lng:y.geometry.location.lng,vicitiny:y.vicinity}});case 3:E(!F),q(_),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function H(e){return X.apply(this,arguments)}function X(){return(X=Object(o.a)(i.a.mark((function e(t){var s,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"add"===t?(n="http://localhost:8000/api/visit_restaurant/",s=1):(n="http://localhost:8000/api/reduce_visit_restaurant/",s=0===D?0:-1),e.next=4,N.post(n,{restaurant_id:y.place_id,user_id:a.id,restaurant_details:{place_id:y.place_id,name:y.name,lat:y.geometry.location.lat,lng:y.geometry.location.lng,vicitiny:y.vicinity}});case 4:U(D+s),q(_),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function Z(){var e=Object(f.a)(),a=e.ready,s=e.value,n=e.suggestions,c=n.status,r=n.data,l=e.setValue,u=e.clearSuggestions;function j(){return(j=Object(o.a)(i.a.mark((function e(a){var s,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l(a,!1),u(),e.next=5,Object(f.b)({address:a});case 5:return s=e.sent,e.next=8,Object(f.c)(s[0]);case 8:n=e.sent,t=n,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}return Object(k.jsx)("div",{children:Object(k.jsxs)(g.a,{onSelect:function(e){return j.apply(this,arguments)},children:[Object(k.jsx)(g.b,{value:s,onChange:function(e){l(e.target.value)},disabled:!a,placeholder:"Leave blank to use current location",className:"mainPageInput"}),Object(k.jsx)(g.d,{children:"OK"===c&&r.map((function(e){var t=e.place_id,a=e.description;return Object(k.jsx)(g.c,{value:a,className:"searchDropDown"},t)}))})]})})}return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(b.a,{className:"justify-content-center",children:Object(k.jsxs)(m.a,{className:"col-10 col-md-8",children:[Object(k.jsxs)(b.a,{className:"justify-content-center",children:[Object(k.jsx)("img",{src:"img/icon.png",width:"30",height:"35",className:"mt-2 mr-1"}),Object(k.jsx)("h1",{children:"What2Eat?"})]}),Object(k.jsx)(b.a,{className:"justify-content-center text-center",children:Object(k.jsx)("h5",{children:"Too busy to think about lunch? Is indecisive your middle name? Let W2E decide for you lah."})}),Object(k.jsx)(b.a,{className:"justify-content-center text-center",style:{fontSize:"10px"},children:"Searches are limited to a 500m radius because you're probably too lazy to walk anyway"}),Object(k.jsx)(b.a,{children:Object(k.jsx)(m.a,{className:"col-12",children:Object(k.jsxs)(x.a,{onSubmit:function(e){return K.apply(this,arguments)},children:[Object(k.jsx)(b.a,{className:"mb-3 mt-3",children:Object(k.jsx)(m.a,{children:Object(k.jsx)(Z,{})})}),Object(k.jsxs)(b.a,{children:[Object(k.jsx)(m.a,{className:"col-12 col-sm-12 col-md-6 col-lg-6 mb-3",children:Object(k.jsx)(x.a.Control,{placeholder:"Cuisine: Surprise Me!",className:"mainPageInput"})}),Object(k.jsx)(m.a,{className:"col-12 col-sm-12 col-md-6 col-lg-6",children:Object(k.jsxs)(x.a.Control,{as:"select",className:"mainPageInput",children:[Object(k.jsx)("option",{value:"Surprise Me!",children:"Price: Default $$"}),Object(k.jsx)("option",{value:"$",children:"$"}),Object(k.jsx)("option",{value:"$$",children:"$$"}),Object(k.jsx)("option",{value:"$$$",children:"$$$"}),Object(k.jsx)("option",{value:"$$$$",children:"$$$$"})]})})]}),Object(k.jsx)(b.a,{className:" mt-3 text-center",children:Object(k.jsx)(m.a,{className:"col-12",children:Object(k.jsx)(O.a,{type:"submit",variant:"danger",id:"mainPageSearch",style:{width:"100%"},children:y?"Something Else!":"Feed Me Now!"})})})]})})})]})}),y?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(b.a,{className:"justify-content-center text-center",children:Object(k.jsxs)(m.a,{className:"col-10 col-md-8",children:[Object(k.jsx)("h5",{className:"mt-3",children:"Here you go friend, something to eat so you wouldn't starve."}),Object(k.jsx)("h3",{children:y.name}),Object(k.jsx)("h5",{children:y.vicinity}),Object(k.jsx)("h5",{children:y.rating?"Rating: ".concat(y.rating,"/5"):"No Rating"}),a?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("h5",{children:["Visits: ",D]}),Object(k.jsxs)("div",{children:[Object(k.jsx)(b.a,{className:"mt-2 text-center",children:Object(k.jsx)(m.a,{className:"col-12",children:F?Object(k.jsx)(O.a,{variant:"success",onClick:J,style:{width:"100%"},children:"Favorite Place"}):Object(k.jsx)(O.a,{variant:"warning",onClick:J,style:{width:"100%"},children:"Add to favorites"})})}),Object(k.jsx)(b.a,{className:"mt-2  text-center",children:Object(k.jsx)(m.a,{children:Object(k.jsx)(O.a,{variant:"warning",onClick:function(){return H("add")},style:{width:"100%"},children:"Log Visit"})})}),Object(k.jsx)(b.a,{className:"mt-2  text-center",children:Object(k.jsx)(m.a,{children:Object(k.jsx)(O.a,{variant:"warning",onClick:function(){return H("minus")},style:{width:"100%"},children:"Remove Visit"})})})]})]}):Object(k.jsx)(k.Fragment,{})]})}),Object(k.jsx)(b.a,{className:"m-3",children:Object(k.jsx)(p.a,{mapContainerStyle:{width:"100vw",height:"50vw"},zoom:10,center:{lat:1.3521,lng:103.8198},options:z,onLoad:W,id:"mapsection",children:_?Object(k.jsx)(p.b,{position:{lat:_.lat,lng:_.lng},icon:{url:"img/icon.png",scaledSize:new window.google.maps.Size(30,30),origin:new window.google.maps.Point(0,0)}}):""})})]}):""]})},C=a(22),T=a(23);a(38);var _=function(e){var t=e.setAuth,a=Object(s.useState)({username:"",email:"",password:"",confirmPassword:""}),n=Object(u.a)(a,2),c=n[0],r=n[1],l=Object(h.f)();function d(){return(d=Object(o.a)(i.a.mark((function e(a){var s,n,r,o,u,j;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,w.a.post("http://localhost:8000/accounts/register/",c);case 4:return window.alert("Registration successful!"),e.next=7,N.post("http://localhost:8000/accounts/login/",c);case 7:s=e.sent,n=s.data,localStorage.setItem("access",n.access),localStorage.setItem("refresh",n.refresh),t(!0),l.push("/"),e.next=22;break;case 15:for(u in e.prev=15,e.t0=e.catch(1),r=e.t0.response.data,o=[],r)for(j in r[u])o.push("- "+r[u][j]);o.length<10?window.alert("The following errors have occured: \n"+o.join("\n")):window.alert("An error has occured, please try again!"),console.log(e.t0);case 22:case"end":return e.stop()}}),e,null,[[1,15]])})))).apply(this,arguments)}function p(e){r(Object(T.a)(Object(T.a)({},c),{},Object(C.a)({},e.target.name,e.target.value)))}return Object(k.jsx)(j.a,{className:"justify-content-center",style:{maxWidth:"300px"},children:Object(k.jsxs)(x.a,{className:"FormBackground p-4 mt-5",children:[Object(k.jsx)("h3",{className:"text-center",children:"Sign Up"}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"User name"}),Object(k.jsx)("input",{type:"text",className:"form-control",placeholder:"Username",name:"username",onChange:p})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"Email address"}),Object(k.jsx)("input",{type:"email",className:"form-control",placeholder:"Enter email",name:"email",onChange:p})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"Password"}),Object(k.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter password",name:"password",onChange:p})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"Confirm Password"}),Object(k.jsx)("input",{type:"password",className:"form-control",placeholder:"Confirm password",name:"confirmPassword",onChange:p})]}),Object(k.jsx)(O.a,{type:"submit",className:"btn btn-primary btn-block",variant:"danger",onClick:function(e){return d.apply(this,arguments)},children:"Sign Up"}),Object(k.jsx)("p",{className:"forgot-password text-center mt-1",children:Object(k.jsx)("a",{href:"/login",children:"Already registered? Click here to Login!"})})]})})};var P=function(e){var t=e.setAuth,a=Object(s.useState)({username:"",password:""}),n=Object(u.a)(a,2),c=n[0],r=n[1],l=Object(h.f)();function d(){return(d=Object(o.a)(i.a.mark((function e(a){var s,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,N.post("http://localhost:8000/accounts/login/",c);case 4:s=e.sent,n=s.data,localStorage.setItem("access",n.access),localStorage.setItem("refresh",n.refresh),t(!0),l.push("/"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function p(e){r(Object(T.a)(Object(T.a)({},c),{},Object(C.a)({},e.target.name,e.target.value)))}return Object(k.jsx)(j.a,{className:"justify-content-center",style:{maxWidth:"300px"},children:Object(k.jsxs)(x.a,{className:"FormBackground p-4 mt-5",children:[Object(k.jsx)("h3",{className:"text-center",children:"Login"}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"User name"}),Object(k.jsx)("input",{type:"text",className:"form-control",placeholder:"Username",name:"username",onChange:p})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"Password"}),Object(k.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter password",name:"password",onChange:p})]}),Object(k.jsx)(O.a,{type:"submit",className:"btn btn-primary btn-block",variant:"danger",onClick:function(e){return d.apply(this,arguments)},children:"Login"}),Object(k.jsx)("p",{className:"forgot-password text-center mt-1",children:Object(k.jsx)("a",{href:"/signup",children:"Not yet registered? Click here to Signup!"})})]})})},$=a(96),L=a(98);var F=function(e){var t=e.user,a=e.setUser,s=e.setAuth,n=Object(h.f)();return Object(k.jsx)($.a,{style:{"background-color":"#97a97c"},expand:"md",children:Object(k.jsxs)(j.a,{children:[Object(k.jsx)($.a.Brand,{href:"/",children:"What2Eat?"}),Object(k.jsx)($.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(k.jsx)($.a.Collapse,{id:"basic-navbar-nav",className:"justify-content-end",children:Object(k.jsx)(L.a,{className:"me-auto",children:(null===t||void 0===t?void 0:t.username)?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(L.a.Link,{href:"/",style:{color:"black"},onClick:function(e){e.preventDefault(),localStorage.clear(),s(!1),a(null),n.push("/")},children:"Logout"}),Object(k.jsxs)(L.a.Link,{href:"/profile",style:{color:"black"},children:["Profile: ",t.username]})]}):Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(L.a.Link,{href:"/signup",style:{color:"black"},children:"Signup"}),Object(k.jsx)(L.a.Link,{href:"/login",style:{color:"black"},children:"Login"})]})})})]})})},E=a(95);var A=function(e){var t=e.user,a=e.userRestaurants,n=Object(s.useState)(!1),c=Object(u.a)(n,2),r=c[0];return c[1],Object(k.jsx)(j.a,{className:"justify-content-center",style:{maxWidth:"500px"},children:r?Object(k.jsx)(k.Fragment,{}):Object(k.jsxs)("div",{className:"FormBackground p-4 mt-4 text-center",children:[Object(k.jsx)("h3",{className:"text-center",children:"Profile"}),Object(k.jsxs)("div",{className:!0,children:["Username: ",t.username]}),Object(k.jsxs)("div",{children:["Email: ",t.email]}),Object(k.jsxs)("div",{className:"text-center mt-3",children:[Object(k.jsx)("h4",{className:"text-center",children:"Places Visited"}),Object(k.jsxs)(E.a,{striped:!0,bordered:!0,hover:!0,size:"sm",children:[Object(k.jsx)("thead",{children:Object(k.jsxs)("tr",{children:[Object(k.jsx)("th",{children:"Restaurant"}),Object(k.jsx)("th",{children:"Vists"})]})}),Object(k.jsx)("tbody",{children:null===a||void 0===a?void 0:a.map((function(e){return Object(k.jsxs)("tr",{children:[Object(k.jsxs)("td",{children:[e.favorite?"\u2b50":"",e.restaurant_name]}),Object(k.jsx)("td",{children:e.visits})]})}))})]})]})]})})},I=a(54);a.n(I).a.config();var D=function(){var e=Object(s.useState)(!1),t=Object(u.a)(e,2),a=t[0],n=t[1],c=Object(s.useState)({}),r=Object(u.a)(c,2),l=r[0],p=r[1],b=Object(s.useState)([]),m=Object(u.a)(b,2),x=m[0],O=m[1];return Object(s.useEffect)((function(){function e(){return(e=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.get("http://localhost:8000/accounts/user/");case 3:t=e.sent,a=t.data,p(a.user_profile),O(a.user_stats),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),n(!1),p(null),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[a]),Object(k.jsxs)(d.a,{children:[Object(k.jsx)(F,{user:l,setUser:n,setAuth:n}),Object(k.jsx)(j.a,{className:"justify-content-center mt-3",children:Object(k.jsxs)(h.c,{children:[Object(k.jsx)(h.a,{path:"/",exact:!0,children:Object(k.jsx)(S,{user:l})}),Object(k.jsx)(h.a,{path:"/signup",children:Object(k.jsx)(_,{setAuth:n})}),Object(k.jsx)(h.a,{path:"/login",children:Object(k.jsx)(P,{setAuth:n})}),Object(k.jsx)(h.a,{path:"/profile",children:Object(k.jsx)(A,{user:l,userRestaurants:x})})]})})]})},U=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,99)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),s(e),n(e),c(e),r(e)}))};a(89);r.a.render(Object(k.jsx)(D,{}),document.getElementById("root")),U()}},[[90,1,2]]]);
//# sourceMappingURL=main.af359578.chunk.js.map